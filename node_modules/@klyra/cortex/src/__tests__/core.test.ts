import {
  describe,
  expect,
  it,
  afterAll,
  jest,
  beforeEach,
} from "@jest/globals";
import { StateManager } from "../core/state-manager";

// Mock WebSocket
jest.mock("ws", () => {
  const MockWebSocket = jest.fn().mockImplementation(() => ({
    onopen: null,
    onclose: null,
    onerror: null,
    onmessage: null,
    send: jest.fn(),
    close: jest.fn(),
    readyState: 1, // OPEN
  }));
  return { WebSocket: MockWebSocket };
});

describe("StateManager", () => {
  let stateManager: StateManager;

  beforeEach(() => {
    stateManager = new StateManager({
      defaultMarketTicker: "ETH-USD",
    });
  });

  afterAll(() => {
    jest.clearAllMocks();
  });

  it("should be defined", () => {
    expect(stateManager).toBeDefined();
  });
});
